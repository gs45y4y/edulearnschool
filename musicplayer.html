<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lofi music player</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
:root {
    --bg:#09090b; --panel:#18181b; --surface:#27272a;
    --text-main:#f4f4f5; --text-sub:#a1a1aa; --border:#3f3f46;
}
*{box-sizing:border-box}
body{
    margin:0;background:var(--bg);color:var(--text-main);
    font-family:Inter,system-ui;height:100vh;
    display:flex;align-items:center;justify-content:center
}
.window{
    width:950px;height:580px;background:var(--panel);
    border-radius:24px;display:flex;overflow:hidden;
    border:1px solid var(--border)
}
.player-zone{
    flex:1.3;padding:35px;display:flex;
    flex-direction:column;border-right:1px solid var(--border)
}
.art-wrapper{
    width:100%;aspect-ratio:1;border-radius:16px;
    overflow:hidden;margin-bottom:25px;background:black
}
.album-art{width:100%;height:100%;object-fit:cover}
.track-title{font-size:1.8rem;font-weight:800}
.track-artist{color:var(--text-sub);margin-bottom:20px}
.scrubber{height:6px;background:var(--surface);border-radius:3px;cursor:pointer}
.scrubber-fill{height:100%;width:0%;background:white}
.timestamps{
    display:flex;justify-content:space-between;
    font-family:monospace;font-size:.8rem;color:var(--text-sub)
}
.controls{margin-top:20px;display:flex;justify-content:center}
.play-btn{
    width:60px;height:60px;border-radius:50%;
    background:white;color:black;
    border:none;font-size:1.4rem;cursor:pointer
}
.list-zone{flex:1;background:var(--bg);display:flex;flex-direction:column}
.search-header{padding:20px;border-bottom:1px solid var(--border)}
.search-input{
    width:100%;padding:14px;background:var(--surface);
    border:1px solid var(--border);
    border-radius:12px;color:white;font-size:1rem
}
.results-area{flex:1;overflow:auto;padding:15px}
.song-item{
    display:flex;gap:12px;padding:10px;
    border-radius:10px;cursor:pointer
}
.song-item:hover{background:var(--surface)}
.song-item img{
    width:50px;height:50px;border-radius:8px;object-fit:cover
}
.song-name{font-weight:600}
.song-art{font-size:.85rem;color:var(--text-sub)}
</style>
</head>

<body>

<div class="window">
    <div class="player-zone">
        <div class="art-wrapper">
            <img id="mainArt" class="album-art"
                 src="https://via.placeholder.com/600">
        </div>

        <div class="track-title" id="mainTitle">No Track</div>
        <div class="track-artist" id="mainArtist">Search to begin</div>

        <div class="scrubber" onclick="seek(event)">
            <div class="scrubber-fill" id="scrubberFill"></div>
        </div>

        <div class="timestamps">
            <span id="currTime">0:00</span>
            <span id="durTime">--:--</span>
        </div>

        <div class="controls">
            <button class="play-btn" onclick="togglePlay()">
                <i class="fas fa-play" id="playIcon"></i>
            </button>
        </div>
    </div>

    <div class="list-zone">
        <div class="search-header">
            <input class="search-input"
                   placeholder="Search Jamendo..."
                   onkeydown="if(event.key==='Enter')search()">
        </div>
        <div class="results-area" id="resultList"></div>
    </div>
</div>

<audio id="audio" crossorigin="anonymous"></audio>

<script>
/* ============ CONFIG ============ */
const JAMENDO_CLIENT_ID = "f5f24149";
/* ================================ */

const audio = document.getElementById("audio");
const mainTitle = document.getElementById("mainTitle");
const mainArtist = document.getElementById("mainArtist");
const mainArt = document.getElementById("mainArt");
const scrubberFill = document.getElementById("scrubberFill");
const playIcon = document.getElementById("playIcon");

/* -------- SEARCH -------- */
async function search() {
    const q = document.querySelector(".search-input").value.trim();
    if (!q) return;

    const list = document.getElementById("resultList");
    list.innerHTML = "";

    const url =
      `https://api.jamendo.com/v3.0/tracks/` +
      `?client_id=${JAMENDO_CLIENT_ID}` +
      `&format=json` +
      `&limit=30` +
      `&search=${encodeURIComponent(q)}` +
      `&include=musicinfo` +
      `&audioformat=mp32`;

    try {
        const res = await fetch(url);
        const json = await res.json();
        const tracks = json.results || [];

        if (!tracks.length) {
            list.innerHTML =
              `<div style="padding:20px;color:#777">No results</div>`;
            return;
        }

        tracks.forEach(track => {
            const el = document.createElement("div");
            el.className = "song-item";
            el.innerHTML = `
                <img src="${track.image || 'https://via.placeholder.com/50'}">
                <div>
                    <div class="song-name">${track.name}</div>
                    <div class="song-art">${track.artist_name}</div>
                </div>
            `;
            el.onclick = () => loadSong(track);
            list.appendChild(el);
        });

    } catch (e) {
        console.error(e);
        list.innerHTML =
          `<div style="padding:20px;color:#f87171">Search failed</div>`;
    }
}

/* -------- PLAYER -------- */
function loadSong(track) {
    mainTitle.innerText = track.name;
    mainArtist.innerText = track.artist_name;
    mainArt.src = track.image || "https://via.placeholder.com/600";

    audio.src = track.audio;
    audio.play();
    updatePlay(true);
}

function togglePlay() {
    if (audio.paused) {
        audio.play(); updatePlay(true);
    } else {
        audio.pause(); updatePlay(false);
    }
}

function updatePlay(p) {
    playIcon.className = p ? "fas fa-pause" : "fas fa-play";
}

/* -------- TIMELINE -------- */
audio.ontimeupdate = () => {
    if (!audio.duration) return;
    scrubberFill.style.width =
        (audio.currentTime / audio.duration) * 100 + "%";
    currTime.innerText = fmt(audio.currentTime);
    durTime.innerText = fmt(audio.duration);
};

function seek(e) {
    if (!audio.duration) return;
    audio.currentTime =
        (e.offsetX / e.target.clientWidth) * audio.duration;
}

function fmt(s) {
    const m = Math.floor(s / 60);
    const sec = Math.floor(s % 60);
    return `${m}:${sec < 10 ? "0" : ""}${sec}`;
}
</script>

</body>
</html>
