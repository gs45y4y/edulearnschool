<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#fb2651">

    <title>Edulearn | Games</title>
    <meta name="title" content="Edulearn | Special Content"> 
    
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://gn-math.github.io/">
    <meta property="og:title" content="Edulearn | Special Content">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://gn-math.github.io/">
    <meta name="twitter:title" content="Edulearn | Special Content">
    
    <link rel="icon" type="image/png" sizes="32x32" href="favicon.png">
    <link rel="apple-touch-icon" href="favicon.png">
    <link rel="manifest" href="manifest.json">

    <link rel="stylesheet" href="style.css">
    <style>
        /* --- IMPORTED THEME SYSTEM FROM EDULEARN LITE --- */
        :root {
            --bg-color: #09090b;
            --text-main: #ffffff;
            --text-muted: #a1a1aa;
            --accent: #6366f1;
        }

        body.theme-mocha {
            --bg-color: #1e1e2e;
            --text-main: #cdd6f4;
            --text-muted: #a6adc8;
            --accent: #cba6f7;
        }

        body.theme-inverted {
            --bg-color: #f4f4f5;
            --text-main: #18181b;
            --text-muted: #52525b;
            --accent: #4f46e5;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Helper styles */
        .ad-container { height: 90px; position: sticky; top: 0; z-index: 10; }
        .section-summary { font-size: 1.2rem; font-weight: bold; cursor: pointer; user-select: none; }
        .hidden { display: none; }
    </style>
</head>

<body>
    
    <header>
        <div class="header-content">
            <div class="logo"> Learning </div>
            
            <div class="search-container">
                <input type="text" id="searchBar" placeholder="Search zones..." aria-label="Search zones" oninput="filterZones()">
                
                <select id="sortOptions" aria-label="Sort zones" onchange="sortZones()">
                    <option value="name">Name</option>
                    <option value="id">ID (Date)</option>
                    <option value="popular">Popular</option>
                </select>
                
                <select id="filterOptions" aria-label="Filter by tag" onchange="filterZones2()">
                    <option value="none">(SELECT TAG)</option>
                </select>
            </div>

            <div class="control-buttons">
                <button id="refresh" class="control-button" title="Refresh all zones" aria-label="Refresh" onclick="listZones()">
                    <img src="refresh-icon.png" alt="" aria-hidden="true">
                </button>

                <button id="settings" class="control-button" title="Settings" aria-label="Settings">
                    <img src="setting.png" alt="" aria-hidden="true">
                </button>
            </div>
        </div>
    </header>

    <main>
        <br>

        <details id="featuredZonesWrapper" open>
            <summary id="allZonesSummary" class="section-summary">Featured</summary>
            <div id="featuredZones" class="zone-container"></div>
        </details>
        
        <br><hr><br>

        <details id="allZonesWrapper" open>
            <summary id="allSummary" class="section-summary">All Games</summary>
            <div id="container">Loading Your Content...</div>
            <div id="container"> <nl> Please Be patient </nl></div>
        </details>
    </main>

    <div id="zoneViewer">
        <div class="zone-header">
            <div class="zone-title">
                <h2 id="zoneName">Zone</h2>
                <button class="info-button" onclick="showZoneInfo()" aria-label="Zone Information" title="Zone Information">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                </button>
                <span id="zoneId" class="hidden"></span>
                <a id="zoneAuthor" href="#" target="_blank">By Author |</a>
                <a id="zoneAuthor" href="#" target="_blank"> | [Errors? Try Reloading OR Launching in another tab.] | Game not loading? Please Be Patient.. </a>
            </div>
            <div class="zone-controls">
                <button onclick="fullscreenZone()">Fullscreen</button>
                <button onclick="aboutBlank()">Open in New Tab</button>
                <button onclick="downloadZone()">Download</button>
                <button onclick="closeZone()">Close</button>
            </div>
        </div>
        <iframe id="zoneFrame" title="Game Content"></iframe>
    </div>
    
    <div id="popupOverlay">
        <div class="popup">
            <div class="popup-header">
                <h3 id="popupTitle">Title</h3>
                <button id="popupClose" onclick="closePopup()" aria-label="Close Popup">Ã—</button>
            </div>
            <div id="popupBody">
                Content will be here
            </div>
        </div>
    </div>

    <footer class="footer-links">
        <a href="#" onclick="loadDMCA(); return false;">DMCA</a>
        <a href="#" onclick="showContact(); return false;">Contact</a>
        <a href="#" onclick="loadPrivacy(); return false;">Privacy Policy</a>
        <a href="javascript:saveData()">Export Data</a>
        <a href="#" onclick="document.getElementById('importData').click(); return false;">Import Data</a>
        <input type="file" id="importData" class="hidden" onchange="loadData(event)">
    </footer>

    <script src="script.js" defer></script>
    <script>
        // --- EDULEARN THEME SYNC ---
        function syncEdulearnTheme() {
            try {
                // Fetch settings from local storage
                const savedSettings = JSON.parse(localStorage.getItem('el_settings')) || {};
                const theme = savedSettings.theme || 'default';
                const bgUrl = savedSettings.bgUrl || '';

                // Apply correct theme class
                document.body.className = theme === 'default' ? '' : `theme-${theme}`;

                // Apply custom background image if set
                if (bgUrl) {
                    document.body.style.backgroundImage = `url('${bgUrl}')`;
                    document.body.style.backgroundSize = 'cover';
                    document.body.style.backgroundPosition = 'center';
                    document.body.style.backgroundAttachment = 'fixed';
                } else {
                    document.body.style.backgroundImage = 'none';
                }
            } catch (err) {
                console.error("Theme sync failed:", err);
            }
        }

        // Run on initial load
        syncEdulearnTheme();

        // Listen for changes across other pages/frames (so it updates instantly without refresh)
        window.addEventListener('storage', (e) => {
            if (e.key === 'el_settings') {
                syncEdulearnTheme();
            }
        });

        // -----------------------------------

        // Check for privacy parameter
        const searchParams = new URLSearchParams(window.location.search);
        if (searchParams.get('privacy')) {
            if(typeof loadPrivacy === 'function') loadPrivacy();
        }

        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js')
                .then(reg => console.log('SW Registered'))
                .catch(err => console.error('SW Registration failed', err));
        }
    </script>
</body>
</html>